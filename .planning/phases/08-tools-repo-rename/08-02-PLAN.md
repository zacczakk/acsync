---
phase: 08-tools-repo-rename
plan: 02
type: execute
wave: 2
depends_on: ["08-01"]
files_modified:
  - configs/instructions/AGENTS.md
  - configs/commands/acsync-configs.md
  - configs/commands/acsync-helpers.md
  - configs/commands/groom-docs.md
  - configs/settings/opencode.json
  - SYNC.md
  - docs/subagent.md
  - docs/plans/active/vsync-alignment/PLAN.md
  - docs/plans/active/simplify-canonical/PLAN.md
autonomous: false
requirements: [REPO-01, REPO-02, REPO-03, REPO-04, REPO-05, REPO-06]

must_haves:
  truths:
    - "Repo lives at ~/Repos/acsync (not ~/Repos/agents)"
    - "acsync binary works from PATH after bun link in new location"
    - "All internal references use ~/Repos/acsync"
    - "acsync push --force propagates path changes to all 4 CLI targets"
    - "Stale target files removed: OPENCODE.md, GEMINI.md, instructions.md"
    - "OpenCode opencode.json instructions points to AGENTS.md"
  artifacts:
    - path: "configs/instructions/AGENTS.md"
      provides: "Instructions with updated repo paths"
      contains: "~/Repos/acsync"
    - path: "configs/settings/opencode.json"
      provides: "OpenCode settings with correct instructions path"
      contains: "AGENTS.md"
  key_links:
    - from: "configs/settings/opencode.json"
      to: "~/.config/opencode/opencode.json"
      via: "acsync push renders settings to target"
      pattern: "AGENTS\\.md"
    - from: "configs/instructions/AGENTS.md"
      to: "~/.claude/CLAUDE.md"
      via: "acsync push renders instructions to all 4 targets"
      pattern: "~/Repos/acsync"
---

<objective>
Rename repo from ~/Repos/agents to ~/Repos/acsync, update all internal path references, re-register binary, push changes to all targets, and clean up stale files.

Purpose: Align repo folder name with the CLI binary name (acsync) for clarity. This is the final phase — touches all path references project-wide.
Output: Repo at ~/Repos/acsync with all paths updated, all targets synced, stale files removed.
</objective>

<execution_context>
@/Users/m332023/.config/opencode/get-shit-done/workflows/execute-plan.md
@/Users/m332023/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-tools-repo-rename/08-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update all ~/Repos/agents path references to ~/Repos/acsync</name>
  <files>
    configs/instructions/AGENTS.md
    configs/commands/acsync-configs.md
    configs/commands/acsync-helpers.md
    configs/commands/groom-docs.md
    configs/settings/opencode.json
    SYNC.md
    docs/subagent.md
    docs/plans/active/vsync-alignment/PLAN.md
    docs/plans/active/simplify-canonical/PLAN.md
  </files>
  <action>
Global find-and-replace `~/Repos/agents` → `~/Repos/acsync` in these files:

1. **configs/instructions/AGENTS.md** (~25 occurrences) — repo path in all sections. Also fix any stale `configs/common/` references to `configs/`.
2. **configs/commands/acsync-configs.md** (5 occurrences) — sync command references
3. **configs/commands/acsync-helpers.md** (4 occurrences) — helper sync references
4. **configs/commands/groom-docs.md** (1 occurrence) — docs reference
5. **SYNC.md** (3 occurrences) — sync playbook paths
6. **docs/subagent.md** (1 occurrence) — subagent model reference
7. **docs/plans/active/vsync-alignment/PLAN.md** (1 occurrence)
8. **docs/plans/active/simplify-canonical/PLAN.md** (5 occurrences)

Additionally fix REPO-05:
9. **configs/settings/opencode.json** — change `~/.config/opencode/OPENCODE.md` to `~/.config/opencode/AGENTS.md` in the `instructions` array

Use `sed -i '' 's|~/Repos/agents|~/Repos/acsync|g'` for the bulk replacement.
Use targeted edit for opencode.json instructions change.

After replacement, verify:
- `rg "~/Repos/agents" . --type ts --type md --type json -g '!.planning/' -g '!node_modules/' -g '!backups/'` returns 0 matches
- `rg "OPENCODE.md" configs/settings/opencode.json` returns 0 matches
  </action>
  <verify>
- Zero old path refs: `rg -c "~/Repos/agents" . --type ts --type md --type json -g '!.planning/' -g '!node_modules/' -g '!backups/' 2>/dev/null | wc -l` = 0
- OpenCode settings fixed: `rg "AGENTS.md" configs/settings/opencode.json`
- Tests pass: `bun test` (path strings in tests may need updating too — check and fix if so)
  </verify>
  <done>All internal ~/Repos/agents references updated to ~/Repos/acsync; OpenCode settings instructions points to AGENTS.md</done>
</task>

<task type="auto">
  <name>Task 2: Commit path changes and pre-rename safety checks</name>
  <files>None (git operations only)</files>
  <action>
1. **Run tests before the rename** to confirm path changes from Task 1 are safe:
    ```bash
    bun test
    ```
    All tests must pass. If any fail due to path changes, fix them before proceeding.

2. **Commit all path changes from Task 1:**
    ```
    committer "feat(08): update all path references ~/Repos/agents → ~/Repos/acsync" <files from task 1>
    ```

3. **Verify commit is clean:**
    ```bash
    git status --short
    ```
    Should show no modified tracked files related to this plan.

4. **STOP. Do NOT proceed to the rename.** Print the following handoff message for the user:

    ---
    SESSION BOUNDARY — MANUAL STEPS REQUIRED

    The code changes are committed. The `mv` rename will break this OpenCode session
    (cwd becomes dangling). You must do the rename yourself, then open a new session.

    Run these commands in your terminal (NOT inside OpenCode):

    ```bash
    # Step 1: Rename the repo
    mv ~/Repos/agents ~/Repos/acsync

    # Step 2: Open a new OpenCode session from the new location
    cd ~/Repos/acsync && opencode
    ```

    Then in the new session, say:
    "Execute 08-02 Task 3 — post-rename steps (bun link, test, push, stale cleanup)"
    ---
  </action>
  <verify>
- Tests green: `bun test` passes before rename
- Commit exists: `git log -1 --oneline` shows the path-update commit
- No uncommitted path changes: `git diff --name-only` is empty for plan files
  </verify>
  <done>Path changes committed, tests green, ready for manual rename + session handoff</done>
</task>

<task type="auto">
  <name>Task 3: Post-rename — re-link binary, push to targets, clean stale files</name>
  <files>None (filesystem + CLI operations only)</files>
  <action>
⚠️ PRECONDITION: This task runs in a NEW OpenCode session started from ~/Repos/acsync.
   Before executing, verify the precondition:
    ```bash
    pwd                              # Must show ~/Repos/acsync
    test -d ~/Repos/agents && echo "ABORT: old dir still exists" || echo "OK: old dir gone"
    git log -1 --oneline             # Should show the path-update commit from Task 2
    ```
   If any check fails, STOP and ask the user.

1. **Re-register the binary from new location:**
    ```bash
    bun link
    ```
    Verify: `which acsync` should show new path, `acsync --help` works.

2. **Run tests from new location:**
    ```bash
    bun test
    ```
    All tests must pass. If any fail due to hardcoded paths in test fixtures, fix them first.

3. **Push all changes to targets:**
    ```bash
    acsync push --force --delete
    ```
    This propagates: updated AGENTS.md (with ~/Repos/acsync paths) to all 4 CLI instruction files, updated opencode.json settings (AGENTS.md instruction ref), and deletes stale commands/agents/skills.

4. **Remove stale instruction files that push won't catch:**
    ```bash
    trash ~/.config/opencode/OPENCODE.md
    trash ~/.gemini/GEMINI.md
    trash ~/.codex/instructions.md
    ```
    These are the old instruction filenames superseded by Phase 7's rename (AGENTS.md). Push writes to the new filenames but doesn't remove the old ones.
    If any file doesn't exist, `trash` will error — that's fine, skip it.

5. **Verify targets are clean:**
    ```bash
    acsync check --pretty
    ```
    Should show zero drift.

    Verify stale files gone:
    ```bash
    ls ~/.config/opencode/OPENCODE.md ~/.gemini/GEMINI.md ~/.codex/instructions.md 2>&1
    ```
    All should report "No such file".

    Verify no old path in targets:
    ```bash
    rg "~/Repos/agents" ~/.claude/CLAUDE.md ~/.config/opencode/AGENTS.md ~/.gemini/AGENTS.md ~/.codex/AGENTS.md 2>/dev/null
    ```
    Should return 0 matches.
  </action>
  <verify>
- Directory exists: `ls ~/Repos/acsync/package.json`
- Old dir gone: `! test -d ~/Repos/agents`
- Binary works: `acsync --help`
- Tests green: `bun test` (from ~/Repos/acsync)
- Zero drift: `acsync check` exit code 0
- Stale files gone: `! test -f ~/.config/opencode/OPENCODE.md && ! test -f ~/.gemini/GEMINI.md && ! test -f ~/.codex/instructions.md`
- No old paths in targets: `rg "~/Repos/agents" ~/.claude/CLAUDE.md ~/.config/opencode/AGENTS.md ~/.gemini/AGENTS.md ~/.codex/AGENTS.md 2>/dev/null | wc -l` = 0
  </verify>
  <done>Repo renamed to ~/Repos/acsync, binary re-linked, all targets synced with correct paths, stale instruction files removed</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 4: Verify repo rename and target propagation</name>
  <files>None</files>
  <action>
Verify the repo rename completed successfully. What was built:
- Repo renamed from ~/Repos/agents to ~/Repos/acsync
- All internal path references updated
- All 4 CLI target instruction files synced with new paths
- OpenCode settings instructions array updated
- Stale old-named instruction files removed

Steps to verify:
1. Open a new terminal — verify `cd ~/Repos/acsync` works
2. Run `acsync check --pretty` — should show zero drift
3. Run `acsync --help` — should show help from new location
4. Verify old location gone: `ls ~/Repos/agents` should fail
5. Verify stale files gone: `ls ~/.config/opencode/OPENCODE.md` should fail
6. Spot-check a target: `head -5 ~/.claude/CLAUDE.md` should reference ~/Repos/acsync
  </action>
  <verify>User confirms all checks pass</verify>
  <done>User approved: repo rename verified working end-to-end</done>
</task>

</tasks>

<verification>
- `~/Repos/acsync` exists, `~/Repos/agents` does not
- `acsync` binary resolves to `~/Repos/acsync` and works
- `bun test` passes from `~/Repos/acsync`
- `acsync check` shows zero drift (exit code 0)
- No `~/Repos/agents` references in any target file
- No stale instruction files exist (OPENCODE.md, GEMINI.md, instructions.md)
- OpenCode's `opencode.json` instructions array references `AGENTS.md`
</verification>

<success_criteria>
- REPO-01: Repo folder is ~/Repos/acsync
- REPO-02: All internal ~/Repos/agents references updated to ~/Repos/acsync
- REPO-03: acsync binary works from PATH after bun link in new location
- REPO-04: acsync push --force succeeds with no ~/Repos/agents references in targets
- REPO-05: OpenCode opencode.json instructions points to AGENTS.md
- REPO-06: Stale files removed (OPENCODE.md, GEMINI.md, instructions.md)
</success_criteria>

<output>
After completion, create `.planning/phases/08-tools-repo-rename/08-02-SUMMARY.md`
</output>
